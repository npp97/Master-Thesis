<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T3U3">W</span> = OrgEnergy(<span class="var type1" id="S3T1U6">Xp</span>,<span class="var type1" id="S4T2U7">rstar</span>,<span class="var type1" id="S5T2U8">D0</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">2</a></span><span class="line">    assert( isa( <span class="var type1" id="S3T1U14">Xp</span> , <span class="string">'double'</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">3</a></span><span class="line">    assert( isa( <span class="var type1" id="S4T2U21">rstar</span> , <span class="string">'double'</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">4</a></span><span class="line">    assert( isa( <span class="var type1" id="S5T2U28">D0</span> , <span class="string">'double'</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">5</a></span><span class="line">    <span class="var type0" id="S8T0U32">Dp</span> = <span class="message error" id="M1F1C">calcDp_mex(<span class="var type1" id="S3T1U35">Xp</span>,<span class="var type1" id="S3T1U36">Xp</span>,<span class="var type1" id="S4T2U37">rstar</span>,<span class="var type1" id="S5T2U38">D0</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">6</a></span><span class="line">    <span class="var type0" id="S10T0U41">Dpq</span> = bsxfun(<span class="mxinfo" id="T4:U12">@min</span>,<span class="var type0" id="S8T0U46"><span class="message error" id="M2F1C">Dp</span></span>,<span class="var type0" id="S8T0U48">Dp</span>');</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">7</a></span><span class="line">    <span class="var type2" id="S2T0U51">W</span> = sum(sum(<span class="var type0" id="S10T0U58"><span class="message error" id="M3F1C">Dpq</span></span>.^2.*V1(distm(<span class="var type2" id="S3T0U65">Xp</span>,<span class="var type2" id="S3T0U66">Xp</span>)./<span class="var type0" id="S10T0U67">Dpq</span>)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">8</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
