function [res_S,flag,new_data] = MCM_res_S(t,x,dx,res,sx,dsx,data) 

theta = data.params;

res_S =  [theta(2)*sx(2,1) - x(1) - dsx(1,1) - theta(1)*sx(1,1),x(2) - dsx(1,2) + theta(2)*sx(2,2) - theta(1)*sx(1,2),theta(2)*sx(2,3) - dsx(1,3) - theta(1)*sx(1,3),theta(2)*sx(2,4) - dsx(1,4) - theta(1)*sx(1,4),theta(2)*sx(2,5) - dsx(1,5) - theta(1)*sx(1,5),theta(2)*sx(2,6) - dsx(1,6) - theta(1)*sx(1,6);...
         x(1) - dsx(2,1) - theta(2)*sx(2,1) + theta(1)*sx(1,1),theta(1)*sx(1,2) - x(2) - theta(2)*sx(2,2) - dsx(2,2),theta(1)*sx(1,3) - theta(2)*sx(2,3) - dsx(2,3),theta(1)*sx(1,4) - theta(2)*sx(2,4) - dsx(2,4),theta(1)*sx(1,5) - theta(2)*sx(2,5) - dsx(2,5),theta(1)*sx(1,6) - theta(2)*sx(2,6) - dsx(2,6);...
         sx(2,1)*(theta(2)*x(8) - theta(2)*x(3)) - dsx(3,1)*x(1) - dx(3)*sx(1,1) - sx(3,1)*(theta(2)*x(2) + theta(4)*x(1)) - theta(4)*sx(1,1)*x(3) + theta(2)*sx(8,1)*x(2),x(2)*(x(8) - x(3)) - dsx(3,2)*x(1) - dx(3)*sx(1,2) + sx(2,2)*(theta(2)*x(8) - theta(2)*x(3)) - sx(3,2)*(theta(2)*x(2) + theta(4)*x(1)) - theta(4)*sx(1,2)*x(3) + theta(2)*sx(8,2)*x(2),sx(2,3)*(theta(2)*x(8) - theta(2)*x(3)) - dsx(3,3)*x(1) - dx(3)*sx(1,3) - sx(3,3)*(theta(2)*x(2) + theta(4)*x(1)) - theta(4)*sx(1,3)*x(3) + theta(2)*sx(8,3)*x(2),sx(2,4)*(theta(2)*x(8) - theta(2)*x(3)) - dsx(3,4)*x(1) - x(3)*x(1) - dx(3)*sx(1,4) - sx(3,4)*(theta(2)*x(2) + theta(4)*x(1)) - theta(4)*sx(1,4)*x(3) + theta(2)*sx(8,4)*x(2),sx(2,5)*(theta(2)*x(8) - theta(2)*x(3)) - dsx(3,5)*x(1) - dx(3)*sx(1,5) - sx(3,5)*(theta(2)*x(2) + theta(4)*x(1)) - theta(4)*sx(1,5)*x(3) + theta(2)*sx(8,5)*x(2),sx(2,6)*(theta(2)*x(8) - theta(2)*x(3)) - dsx(3,6)*x(1) - dx(3)*sx(1,6) - sx(3,6)*(theta(2)*x(2) + theta(4)*x(1)) - theta(4)*sx(1,6)*x(3) + theta(2)*sx(8,6)*x(2);...
         sx(2,1)*(theta(2)*x(9) - theta(2)*x(4)) - dsx(4,1)*x(1) - dx(4)*sx(1,1) + sx(1,1)*(theta(5)*x(3) - theta(6)*x(4)) - sx(4,1)*(theta(2)*x(2) + theta(6)*x(1)) + theta(5)*sx(3,1)*x(1) + theta(2)*sx(9,1)*x(2),x(2)*(x(9) - x(4)) - dsx(4,2)*x(1) - dx(4)*sx(1,2) + sx(2,2)*(theta(2)*x(9) - theta(2)*x(4)) + sx(1,2)*(theta(5)*x(3) - theta(6)*x(4)) - sx(4,2)*(theta(2)*x(2) + theta(6)*x(1)) + theta(5)*sx(3,2)*x(1) + theta(2)*sx(9,2)*x(2),sx(2,3)*(theta(2)*x(9) - theta(2)*x(4)) - dsx(4,3)*x(1) - dx(4)*sx(1,3) + sx(1,3)*(theta(5)*x(3) - theta(6)*x(4)) - sx(4,3)*(theta(2)*x(2) + theta(6)*x(1)) + theta(5)*sx(3,3)*x(1) + theta(2)*sx(9,3)*x(2),sx(2,4)*(theta(2)*x(9) - theta(2)*x(4)) - dsx(4,4)*x(1) - dx(4)*sx(1,4) + sx(1,4)*(theta(5)*x(3) - theta(6)*x(4)) - sx(4,4)*(theta(2)*x(2) + theta(6)*x(1)) + theta(5)*sx(3,4)*x(1) + theta(2)*sx(9,4)*x(2),x(3)*x(1) - dsx(4,5)*x(1) - dx(4)*sx(1,5) + sx(2,5)*(theta(2)*x(9) - theta(2)*x(4)) + sx(1,5)*(theta(5)*x(3) - theta(6)*x(4)) - sx(4,5)*(theta(2)*x(2) + theta(6)*x(1)) + theta(5)*sx(3,5)*x(1) + theta(2)*sx(9,5)*x(2),sx(2,6)*(theta(2)*x(9) - theta(2)*x(4)) - dsx(4,6)*x(1) - x(4)*x(1) - dx(4)*sx(1,6) + sx(1,6)*(theta(5)*x(3) - theta(6)*x(4)) - sx(4,6)*(theta(2)*x(2) + theta(6)*x(1)) + theta(5)*sx(3,6)*x(1) + theta(2)*sx(9,6)*x(2);...
         sx(3,1)*(theta(4)*x(1) - theta(2)*x(2)*(2*x(8) - 2*x(3))) - dsx(5,1)*x(1) - sx(1,1)*(2*x(5)*theta(4) - theta(4)*x(3)) - dx(5)*sx(1,1) - sx(5,1)*(theta(2)*x(2) + 2*theta(4)*x(1)) + sx(2,1)*(x(10)*theta(2) - x(5)*theta(2) + theta(2)*(x(8) - x(3))^2) + theta(2)*sx(10,1)*x(2) + theta(2)*sx(8,1)*x(2)*(2*x(8) - 2*x(3)),x(2)*(x(10) - x(5) + (x(8) - x(3))^2) - dx(5)*sx(1,2) - dsx(5,2)*x(1) - sx(1,2)*(2*x(5)*theta(4) - theta(4)*x(3)) + sx(3,2)*(theta(4)*x(1) - theta(2)*x(2)*(2*x(8) - 2*x(3))) - sx(5,2)*(theta(2)*x(2) + 2*theta(4)*x(1)) + sx(2,2)*(x(10)*theta(2) - x(5)*theta(2) + theta(2)*(x(8) - x(3))^2) + theta(2)*sx(10,2)*x(2) + theta(2)*sx(8,2)*x(2)*(2*x(8) - 2*x(3)),sx(3,3)*(theta(4)*x(1) - theta(2)*x(2)*(2*x(8) - 2*x(3))) - dsx(5,3)*x(1) - sx(1,3)*(2*x(5)*theta(4) - theta(4)*x(3)) - dx(5)*sx(1,3) - sx(5,3)*(theta(2)*x(2) + 2*theta(4)*x(1)) + sx(2,3)*(x(10)*theta(2) - x(5)*theta(2) + theta(2)*(x(8) - x(3))^2) + theta(2)*sx(10,3)*x(2) + theta(2)*sx(8,3)*x(2)*(2*x(8) - 2*x(3)),x(3)*x(1) - dx(5)*sx(1,4) - dsx(5,4)*x(1) - 2*x(5)*x(1) - sx(1,4)*(2*x(5)*theta(4) - theta(4)*x(3)) + sx(3,4)*(theta(4)*x(1) - theta(2)*x(2)*(2*x(8) - 2*x(3))) - sx(5,4)*(theta(2)*x(2) + 2*theta(4)*x(1)) + sx(2,4)*(x(10)*theta(2) - x(5)*theta(2) + theta(2)*(x(8) - x(3))^2) + theta(2)*sx(10,4)*x(2) + theta(2)*sx(8,4)*x(2)*(2*x(8) - 2*x(3)),sx(3,5)*(theta(4)*x(1) - theta(2)*x(2)*(2*x(8) - 2*x(3))) - dsx(5,5)*x(1) - sx(1,5)*(2*x(5)*theta(4) - theta(4)*x(3)) - dx(5)*sx(1,5) - sx(5,5)*(theta(2)*x(2) + 2*theta(4)*x(1)) + sx(2,5)*(x(10)*theta(2) - x(5)*theta(2) + theta(2)*(x(8) - x(3))^2) + theta(2)*sx(10,5)*x(2) + theta(2)*sx(8,5)*x(2)*(2*x(8) - 2*x(3)),sx(3,6)*(theta(4)*x(1) - theta(2)*x(2)*(2*x(8) - 2*x(3))) - dsx(5,6)*x(1) - sx(1,6)*(2*x(5)*theta(4) - theta(4)*x(3)) - dx(5)*sx(1,6) - sx(5,6)*(theta(2)*x(2) + 2*theta(4)*x(1)) + sx(2,6)*(x(10)*theta(2) - x(5)*theta(2) + theta(2)*(x(8) - x(3))^2) + theta(2)*sx(10,6)*x(2) + theta(2)*sx(8,6)*x(2)*(2*x(8) - 2*x(3));...
         sx(2,1)*(x(11)*theta(2) - x(6)*theta(2) + theta(2)*(x(8) - x(3))*(x(9) - x(4))) - dx(6)*sx(1,1) - dsx(6,1)*x(1) - sx(1,1)*(x(6)*theta(4) - x(5)*theta(5) + x(6)*theta(6)) - sx(6,1)*(theta(2)*x(2) + theta(4)*x(1) + theta(6)*x(1)) + theta(5)*sx(5,1)*x(1) + theta(2)*sx(11,1)*x(2) + theta(2)*sx(8,1)*x(2)*(x(9) - x(4)) - theta(2)*sx(3,1)*x(2)*(x(9) - x(4)) + theta(2)*sx(9,1)*x(2)*(x(8) - x(3)) - theta(2)*sx(4,1)*x(2)*(x(8) - x(3)),sx(2,2)*(x(11)*theta(2) - x(6)*theta(2) + theta(2)*(x(8) - x(3))*(x(9) - x(4))) - dx(6)*sx(1,2) - dsx(6,2)*x(1) - sx(1,2)*(x(6)*theta(4) - x(5)*theta(5) + x(6)*theta(6)) + x(2)*(x(11) - x(6) + (x(8) - x(3))*(x(9) - x(4))) - sx(6,2)*(theta(2)*x(2) + theta(4)*x(1) + theta(6)*x(1)) + theta(5)*sx(5,2)*x(1) + theta(2)*sx(11,2)*x(2) + theta(2)*sx(8,2)*x(2)*(x(9) - x(4)) - theta(2)*sx(3,2)*x(2)*(x(9) - x(4)) + theta(2)*sx(9,2)*x(2)*(x(8) - x(3)) - theta(2)*sx(4,2)*x(2)*(x(8) - x(3)),sx(2,3)*(x(11)*theta(2) - x(6)*theta(2) + theta(2)*(x(8) - x(3))*(x(9) - x(4))) - dx(6)*sx(1,3) - dsx(6,3)*x(1) - sx(1,3)*(x(6)*theta(4) - x(5)*theta(5) + x(6)*theta(6)) - sx(6,3)*(theta(2)*x(2) + theta(4)*x(1) + theta(6)*x(1)) + theta(5)*sx(5,3)*x(1) + theta(2)*sx(11,3)*x(2) + theta(2)*sx(8,3)*x(2)*(x(9) - x(4)) - theta(2)*sx(3,3)*x(2)*(x(9) - x(4)) + theta(2)*sx(9,3)*x(2)*(x(8) - x(3)) - theta(2)*sx(4,3)*x(2)*(x(8) - x(3)),sx(2,4)*(x(11)*theta(2) - x(6)*theta(2) + theta(2)*(x(8) - x(3))*(x(9) - x(4))) - x(6)*x(1) - dx(6)*sx(1,4) - dsx(6,4)*x(1) - sx(1,4)*(x(6)*theta(4) - x(5)*theta(5) + x(6)*theta(6)) - sx(6,4)*(theta(2)*x(2) + theta(4)*x(1) + theta(6)*x(1)) + theta(5)*sx(5,4)*x(1) + theta(2)*sx(11,4)*x(2) + theta(2)*sx(8,4)*x(2)*(x(9) - x(4)) - theta(2)*sx(3,4)*x(2)*(x(9) - x(4)) + theta(2)*sx(9,4)*x(2)*(x(8) - x(3)) - theta(2)*sx(4,4)*x(2)*(x(8) - x(3)),x(5)*x(1) + sx(2,5)*(x(11)*theta(2) - x(6)*theta(2) + theta(2)*(x(8) - x(3))*(x(9) - x(4))) - dx(6)*sx(1,5) - dsx(6,5)*x(1) - sx(1,5)*(x(6)*theta(4) - x(5)*theta(5) + x(6)*theta(6)) - sx(6,5)*(theta(2)*x(2) + theta(4)*x(1) + theta(6)*x(1)) + theta(5)*sx(5,5)*x(1) + theta(2)*sx(11,5)*x(2) + theta(2)*sx(8,5)*x(2)*(x(9) - x(4)) - theta(2)*sx(3,5)*x(2)*(x(9) - x(4)) + theta(2)*sx(9,5)*x(2)*(x(8) - x(3)) - theta(2)*sx(4,5)*x(2)*(x(8) - x(3)),sx(2,6)*(x(11)*theta(2) - x(6)*theta(2) + theta(2)*(x(8) - x(3))*(x(9) - x(4))) - x(6)*x(1) - dx(6)*sx(1,6) - dsx(6,6)*x(1) - sx(1,6)*(x(6)*theta(4) - x(5)*theta(5) + x(6)*theta(6)) - sx(6,6)*(theta(2)*x(2) + theta(4)*x(1) + theta(6)*x(1)) + theta(5)*sx(5,6)*x(1) + theta(2)*sx(11,6)*x(2) + theta(2)*sx(8,6)*x(2)*(x(9) - x(4)) - theta(2)*sx(3,6)*x(2)*(x(9) - x(4)) + theta(2)*sx(9,6)*x(2)*(x(8) - x(3)) - theta(2)*sx(4,6)*x(2)*(x(8) - x(3));...
         sx(4,1)*(theta(6)*x(1) - theta(2)*x(2)*(2*x(9) - 2*x(4))) - dsx(7,1)*x(1) - dx(7)*sx(1,1) - sx(7,1)*(theta(2)*x(2) + 2*theta(6)*x(1)) + sx(1,1)*(2*x(6)*theta(5) - 2*x(7)*theta(6) + theta(5)*x(3) + theta(6)*x(4)) + sx(2,1)*(x(12)*theta(2) - x(7)*theta(2) + theta(2)*(x(9) - x(4))^2) + 2*theta(5)*sx(6,1)*x(1) + theta(2)*sx(12,1)*x(2) + theta(5)*sx(3,1)*x(1) + theta(2)*sx(9,1)*x(2)*(2*x(9) - 2*x(4)),x(2)*(x(12) - x(7) + (x(9) - x(4))^2) - dx(7)*sx(1,2) - dsx(7,2)*x(1) + sx(4,2)*(theta(6)*x(1) - theta(2)*x(2)*(2*x(9) - 2*x(4))) - sx(7,2)*(theta(2)*x(2) + 2*theta(6)*x(1)) + sx(1,2)*(2*x(6)*theta(5) - 2*x(7)*theta(6) + theta(5)*x(3) + theta(6)*x(4)) + sx(2,2)*(x(12)*theta(2) - x(7)*theta(2) + theta(2)*(x(9) - x(4))^2) + 2*theta(5)*sx(6,2)*x(1) + theta(2)*sx(12,2)*x(2) + theta(5)*sx(3,2)*x(1) + theta(2)*sx(9,2)*x(2)*(2*x(9) - 2*x(4)),sx(4,3)*(theta(6)*x(1) - theta(2)*x(2)*(2*x(9) - 2*x(4))) - dsx(7,3)*x(1) - dx(7)*sx(1,3) - sx(7,3)*(theta(2)*x(2) + 2*theta(6)*x(1)) + sx(1,3)*(2*x(6)*theta(5) - 2*x(7)*theta(6) + theta(5)*x(3) + theta(6)*x(4)) + sx(2,3)*(x(12)*theta(2) - x(7)*theta(2) + theta(2)*(x(9) - x(4))^2) + 2*theta(5)*sx(6,3)*x(1) + theta(2)*sx(12,3)*x(2) + theta(5)*sx(3,3)*x(1) + theta(2)*sx(9,3)*x(2)*(2*x(9) - 2*x(4)),sx(4,4)*(theta(6)*x(1) - theta(2)*x(2)*(2*x(9) - 2*x(4))) - dsx(7,4)*x(1) - dx(7)*sx(1,4) - sx(7,4)*(theta(2)*x(2) + 2*theta(6)*x(1)) + sx(1,4)*(2*x(6)*theta(5) - 2*x(7)*theta(6) + theta(5)*x(3) + theta(6)*x(4)) + sx(2,4)*(x(12)*theta(2) - x(7)*theta(2) + theta(2)*(x(9) - x(4))^2) + 2*theta(5)*sx(6,4)*x(1) + theta(2)*sx(12,4)*x(2) + theta(5)*sx(3,4)*x(1) + theta(2)*sx(9,4)*x(2)*(2*x(9) - 2*x(4)),2*x(6)*x(1) - dx(7)*sx(1,5) - dsx(7,5)*x(1) + x(3)*x(1) + sx(4,5)*(theta(6)*x(1) - theta(2)*x(2)*(2*x(9) - 2*x(4))) - sx(7,5)*(theta(2)*x(2) + 2*theta(6)*x(1)) + sx(1,5)*(2*x(6)*theta(5) - 2*x(7)*theta(6) + theta(5)*x(3) + theta(6)*x(4)) + sx(2,5)*(x(12)*theta(2) - x(7)*theta(2) + theta(2)*(x(9) - x(4))^2) + 2*theta(5)*sx(6,5)*x(1) + theta(2)*sx(12,5)*x(2) + theta(5)*sx(3,5)*x(1) + theta(2)*sx(9,5)*x(2)*(2*x(9) - 2*x(4)),x(4)*x(1) - dx(7)*sx(1,6) - dsx(7,6)*x(1) - 2*x(7)*x(1) + sx(4,6)*(theta(6)*x(1) - theta(2)*x(2)*(2*x(9) - 2*x(4))) - sx(7,6)*(theta(2)*x(2) + 2*theta(6)*x(1)) + sx(1,6)*(2*x(6)*theta(5) - 2*x(7)*theta(6) + theta(5)*x(3) + theta(6)*x(4)) + sx(2,6)*(x(12)*theta(2) - x(7)*theta(2) + theta(2)*(x(9) - x(4))^2) + 2*theta(5)*sx(6,6)*x(1) + theta(2)*sx(12,6)*x(2) + theta(5)*sx(3,6)*x(1) + theta(2)*sx(9,6)*x(2)*(2*x(9) - 2*x(4));...
         x(3)*x(1) - dsx(8,1)*x(2) - x(8)*x(1) - dx(8)*sx(2,1) - sx(1,1)*(theta(1)*x(8) - theta(1)*x(3)) - sx(8,1)*(theta(4)*x(2) + theta(1)*x(1)) + sx(2,1)*(theta(3) - theta(4)*x(8)) + theta(1)*sx(3,1)*x(1),sx(2,2)*(theta(3) - theta(4)*x(8)) - dsx(8,2)*x(2) - sx(1,2)*(theta(1)*x(8) - theta(1)*x(3)) - sx(8,2)*(theta(4)*x(2) + theta(1)*x(1)) - dx(8)*sx(2,2) + theta(1)*sx(3,2)*x(1),x(2) - dx(8)*sx(2,3) - dsx(8,3)*x(2) - sx(1,3)*(theta(1)*x(8) - theta(1)*x(3)) - sx(8,3)*(theta(4)*x(2) + theta(1)*x(1)) + sx(2,3)*(theta(3) - theta(4)*x(8)) + theta(1)*sx(3,3)*x(1),sx(2,4)*(theta(3) - theta(4)*x(8)) - dsx(8,4)*x(2) - x(8)*x(2) - sx(1,4)*(theta(1)*x(8) - theta(1)*x(3)) - sx(8,4)*(theta(4)*x(2) + theta(1)*x(1)) - dx(8)*sx(2,4) + theta(1)*sx(3,4)*x(1),sx(2,5)*(theta(3) - theta(4)*x(8)) - dsx(8,5)*x(2) - sx(1,5)*(theta(1)*x(8) - theta(1)*x(3)) - sx(8,5)*(theta(4)*x(2) + theta(1)*x(1)) - dx(8)*sx(2,5) + theta(1)*sx(3,5)*x(1),sx(2,6)*(theta(3) - theta(4)*x(8)) - dsx(8,6)*x(2) - sx(1,6)*(theta(1)*x(8) - theta(1)*x(3)) - sx(8,6)*(theta(4)*x(2) + theta(1)*x(1)) - dx(8)*sx(2,6) + theta(1)*sx(3,6)*x(1);...
         x(4)*x(1) - dsx(9,1)*x(2) - x(9)*x(1) - dx(9)*sx(2,1) + sx(2,1)*(theta(5)*x(8) - theta(6)*x(9)) - sx(1,1)*(theta(1)*x(9) - theta(1)*x(4)) - sx(9,1)*(theta(6)*x(2) + theta(1)*x(1)) + theta(5)*sx(8,1)*x(2) + theta(1)*sx(4,1)*x(1),sx(2,2)*(theta(5)*x(8) - theta(6)*x(9)) - dsx(9,2)*x(2) - dx(9)*sx(2,2) - sx(1,2)*(theta(1)*x(9) - theta(1)*x(4)) - sx(9,2)*(theta(6)*x(2) + theta(1)*x(1)) + theta(5)*sx(8,2)*x(2) + theta(1)*sx(4,2)*x(1),sx(2,3)*(theta(5)*x(8) - theta(6)*x(9)) - dsx(9,3)*x(2) - dx(9)*sx(2,3) - sx(1,3)*(theta(1)*x(9) - theta(1)*x(4)) - sx(9,3)*(theta(6)*x(2) + theta(1)*x(1)) + theta(5)*sx(8,3)*x(2) + theta(1)*sx(4,3)*x(1),sx(2,4)*(theta(5)*x(8) - theta(6)*x(9)) - dsx(9,4)*x(2) - dx(9)*sx(2,4) - sx(1,4)*(theta(1)*x(9) - theta(1)*x(4)) - sx(9,4)*(theta(6)*x(2) + theta(1)*x(1)) + theta(5)*sx(8,4)*x(2) + theta(1)*sx(4,4)*x(1),x(8)*x(2) - dsx(9,5)*x(2) - dx(9)*sx(2,5) + sx(2,5)*(theta(5)*x(8) - theta(6)*x(9)) - sx(1,5)*(theta(1)*x(9) - theta(1)*x(4)) - sx(9,5)*(theta(6)*x(2) + theta(1)*x(1)) + theta(5)*sx(8,5)*x(2) + theta(1)*sx(4,5)*x(1),sx(2,6)*(theta(5)*x(8) - theta(6)*x(9)) - dsx(9,6)*x(2) - x(9)*x(2) - dx(9)*sx(2,6) - sx(1,6)*(theta(1)*x(9) - theta(1)*x(4)) - sx(9,6)*(theta(6)*x(2) + theta(1)*x(1)) + theta(5)*sx(8,6)*x(2) + theta(1)*sx(4,6)*x(1);...
         x(5)*x(1) - x(10)*x(1) - dx(10)*sx(2,1) - dsx(10,1)*x(2) + sx(8,1)*(theta(4)*x(2) + theta(1)*x(1)*(2*x(8) - 2*x(3))) - sx(10,1)*(2*theta(4)*x(2) + theta(1)*x(1)) + sx(2,1)*(theta(3) - 2*x(10)*theta(4) + theta(4)*x(8)) + x(1)*(x(8) - x(3))^2 + sx(1,1)*(x(5)*theta(1) - x(10)*theta(1) + theta(1)*(x(8) - x(3))^2) + theta(1)*sx(5,1)*x(1) - theta(1)*sx(3,1)*x(1)*(2*x(8) - 2*x(3)),sx(8,2)*(theta(4)*x(2) + theta(1)*x(1)*(2*x(8) - 2*x(3))) - dsx(10,2)*x(2) - dx(10)*sx(2,2) - sx(10,2)*(2*theta(4)*x(2) + theta(1)*x(1)) + sx(2,2)*(theta(3) - 2*x(10)*theta(4) + theta(4)*x(8)) + sx(1,2)*(x(5)*theta(1) - x(10)*theta(1) + theta(1)*(x(8) - x(3))^2) + theta(1)*sx(5,2)*x(1) - theta(1)*sx(3,2)*x(1)*(2*x(8) - 2*x(3)),x(2) - dx(10)*sx(2,3) - dsx(10,3)*x(2) + sx(8,3)*(theta(4)*x(2) + theta(1)*x(1)*(2*x(8) - 2*x(3))) - sx(10,3)*(2*theta(4)*x(2) + theta(1)*x(1)) + sx(2,3)*(theta(3) - 2*x(10)*theta(4) + theta(4)*x(8)) + sx(1,3)*(x(5)*theta(1) - x(10)*theta(1) + theta(1)*(x(8) - x(3))^2) + theta(1)*sx(5,3)*x(1) - theta(1)*sx(3,3)*x(1)*(2*x(8) - 2*x(3)),sx(8,4)*(theta(4)*x(2) + theta(1)*x(1)*(2*x(8) - 2*x(3))) - dsx(10,4)*x(2) - dx(10)*sx(2,4) - sx(10,4)*(2*theta(4)*x(2) + theta(1)*x(1)) - x(2)*(2*x(10) - x(8)) + sx(2,4)*(theta(3) - 2*x(10)*theta(4) + theta(4)*x(8)) + sx(1,4)*(x(5)*theta(1) - x(10)*theta(1) + theta(1)*(x(8) - x(3))^2) + theta(1)*sx(5,4)*x(1) - theta(1)*sx(3,4)*x(1)*(2*x(8) - 2*x(3)),sx(8,5)*(theta(4)*x(2) + theta(1)*x(1)*(2*x(8) - 2*x(3))) - dsx(10,5)*x(2) - dx(10)*sx(2,5) - sx(10,5)*(2*theta(4)*x(2) + theta(1)*x(1)) + sx(2,5)*(theta(3) - 2*x(10)*theta(4) + theta(4)*x(8)) + sx(1,5)*(x(5)*theta(1) - x(10)*theta(1) + theta(1)*(x(8) - x(3))^2) + theta(1)*sx(5,5)*x(1) - theta(1)*sx(3,5)*x(1)*(2*x(8) - 2*x(3)),sx(8,6)*(theta(4)*x(2) + theta(1)*x(1)*(2*x(8) - 2*x(3))) - dsx(10,6)*x(2) - dx(10)*sx(2,6) - sx(10,6)*(2*theta(4)*x(2) + theta(1)*x(1)) + sx(2,6)*(theta(3) - 2*x(10)*theta(4) + theta(4)*x(8)) + sx(1,6)*(x(5)*theta(1) - x(10)*theta(1) + theta(1)*(x(8) - x(3))^2) + theta(1)*sx(5,6)*x(1) - theta(1)*sx(3,6)*x(1)*(2*x(8) - 2*x(3));...
         x(6)*x(1) - x(11)*x(1) + sx(1,1)*(x(6)*theta(1) - x(11)*theta(1) + theta(1)*(x(8) - x(3))*(x(9) - x(4))) - dx(11)*sx(2,1) - dsx(11,1)*x(2) - sx(2,1)*(x(11)*theta(4) - x(10)*theta(5) + x(11)*theta(6)) - sx(11,1)*(theta(1)*x(1) + x(2)*(theta(4) + theta(6))) + x(1)*(x(8) - x(3))*(x(9) - x(4)) + theta(5)*sx(10,1)*x(2) + theta(1)*sx(6,1)*x(1) + theta(1)*sx(8,1)*x(1)*(x(9) - x(4)) - theta(1)*sx(3,1)*x(1)*(x(9) - x(4)) + theta(1)*sx(9,1)*x(1)*(x(8) - x(3)) - theta(1)*sx(4,1)*x(1)*(x(8) - x(3)),sx(1,2)*(x(6)*theta(1) - x(11)*theta(1) + theta(1)*(x(8) - x(3))*(x(9) - x(4))) - dx(11)*sx(2,2) - dsx(11,2)*x(2) - sx(2,2)*(x(11)*theta(4) - x(10)*theta(5) + x(11)*theta(6)) - sx(11,2)*(theta(1)*x(1) + x(2)*(theta(4) + theta(6))) + theta(5)*sx(10,2)*x(2) + theta(1)*sx(6,2)*x(1) + theta(1)*sx(8,2)*x(1)*(x(9) - x(4)) - theta(1)*sx(3,2)*x(1)*(x(9) - x(4)) + theta(1)*sx(9,2)*x(1)*(x(8) - x(3)) - theta(1)*sx(4,2)*x(1)*(x(8) - x(3)),sx(1,3)*(x(6)*theta(1) - x(11)*theta(1) + theta(1)*(x(8) - x(3))*(x(9) - x(4))) - dx(11)*sx(2,3) - dsx(11,3)*x(2) - sx(2,3)*(x(11)*theta(4) - x(10)*theta(5) + x(11)*theta(6)) - sx(11,3)*(theta(1)*x(1) + x(2)*(theta(4) + theta(6))) + theta(5)*sx(10,3)*x(2) + theta(1)*sx(6,3)*x(1) + theta(1)*sx(8,3)*x(1)*(x(9) - x(4)) - theta(1)*sx(3,3)*x(1)*(x(9) - x(4)) + theta(1)*sx(9,3)*x(1)*(x(8) - x(3)) - theta(1)*sx(4,3)*x(1)*(x(8) - x(3)),sx(1,4)*(x(6)*theta(1) - x(11)*theta(1) + theta(1)*(x(8) - x(3))*(x(9) - x(4))) - x(11)*x(2) - dx(11)*sx(2,4) - dsx(11,4)*x(2) - sx(2,4)*(x(11)*theta(4) - x(10)*theta(5) + x(11)*theta(6)) - sx(11,4)*(theta(1)*x(1) + x(2)*(theta(4) + theta(6))) + theta(5)*sx(10,4)*x(2) + theta(1)*sx(6,4)*x(1) + theta(1)*sx(8,4)*x(1)*(x(9) - x(4)) - theta(1)*sx(3,4)*x(1)*(x(9) - x(4)) + theta(1)*sx(9,4)*x(1)*(x(8) - x(3)) - theta(1)*sx(4,4)*x(1)*(x(8) - x(3)),x(10)*x(2) + sx(1,5)*(x(6)*theta(1) - x(11)*theta(1) + theta(1)*(x(8) - x(3))*(x(9) - x(4))) - dx(11)*sx(2,5) - dsx(11,5)*x(2) - sx(2,5)*(x(11)*theta(4) - x(10)*theta(5) + x(11)*theta(6)) - sx(11,5)*(theta(1)*x(1) + x(2)*(theta(4) + theta(6))) + theta(5)*sx(10,5)*x(2) + theta(1)*sx(6,5)*x(1) + theta(1)*sx(8,5)*x(1)*(x(9) - x(4)) - theta(1)*sx(3,5)*x(1)*(x(9) - x(4)) + theta(1)*sx(9,5)*x(1)*(x(8) - x(3)) - theta(1)*sx(4,5)*x(1)*(x(8) - x(3)),sx(1,6)*(x(6)*theta(1) - x(11)*theta(1) + theta(1)*(x(8) - x(3))*(x(9) - x(4))) - x(11)*x(2) - dx(11)*sx(2,6) - dsx(11,6)*x(2) - sx(2,6)*(x(11)*theta(4) - x(10)*theta(5) + x(11)*theta(6)) - sx(11,6)*(theta(1)*x(1) + x(2)*(theta(4) + theta(6))) + theta(5)*sx(10,6)*x(2) + theta(1)*sx(6,6)*x(1) + theta(1)*sx(8,6)*x(1)*(x(9) - x(4)) - theta(1)*sx(3,6)*x(1)*(x(9) - x(4)) + theta(1)*sx(9,6)*x(1)*(x(8) - x(3)) - theta(1)*sx(4,6)*x(1)*(x(8) - x(3));...
         x(7)*x(1) - x(12)*x(1) - dx(12)*sx(2,1) - dsx(12,1)*x(2) + sx(9,1)*(theta(6)*x(2) + theta(1)*x(1)*(2*x(9) - 2*x(4))) - sx(12,1)*(2*theta(6)*x(2) + theta(1)*x(1)) + sx(2,1)*(2*x(11)*theta(5) - 2*x(12)*theta(6) + theta(5)*x(8) + theta(6)*x(9)) + x(1)*(x(9) - x(4))^2 + sx(1,1)*(x(7)*theta(1) - x(12)*theta(1) + theta(1)*(x(9) - x(4))^2) + 2*theta(5)*sx(11,1)*x(2) + theta(1)*sx(7,1)*x(1) + theta(5)*sx(8,1)*x(2) - theta(1)*sx(4,1)*x(1)*(2*x(9) - 2*x(4)),sx(9,2)*(theta(6)*x(2) + theta(1)*x(1)*(2*x(9) - 2*x(4))) - dsx(12,2)*x(2) - dx(12)*sx(2,2) - sx(12,2)*(2*theta(6)*x(2) + theta(1)*x(1)) + sx(2,2)*(2*x(11)*theta(5) - 2*x(12)*theta(6) + theta(5)*x(8) + theta(6)*x(9)) + sx(1,2)*(x(7)*theta(1) - x(12)*theta(1) + theta(1)*(x(9) - x(4))^2) + 2*theta(5)*sx(11,2)*x(2) + theta(1)*sx(7,2)*x(1) + theta(5)*sx(8,2)*x(2) - theta(1)*sx(4,2)*x(1)*(2*x(9) - 2*x(4)),sx(9,3)*(theta(6)*x(2) + theta(1)*x(1)*(2*x(9) - 2*x(4))) - dsx(12,3)*x(2) - dx(12)*sx(2,3) - sx(12,3)*(2*theta(6)*x(2) + theta(1)*x(1)) + sx(2,3)*(2*x(11)*theta(5) - 2*x(12)*theta(6) + theta(5)*x(8) + theta(6)*x(9)) + sx(1,3)*(x(7)*theta(1) - x(12)*theta(1) + theta(1)*(x(9) - x(4))^2) + 2*theta(5)*sx(11,3)*x(2) + theta(1)*sx(7,3)*x(1) + theta(5)*sx(8,3)*x(2) - theta(1)*sx(4,3)*x(1)*(2*x(9) - 2*x(4)),sx(9,4)*(theta(6)*x(2) + theta(1)*x(1)*(2*x(9) - 2*x(4))) - dsx(12,4)*x(2) - dx(12)*sx(2,4) - sx(12,4)*(2*theta(6)*x(2) + theta(1)*x(1)) + sx(2,4)*(2*x(11)*theta(5) - 2*x(12)*theta(6) + theta(5)*x(8) + theta(6)*x(9)) + sx(1,4)*(x(7)*theta(1) - x(12)*theta(1) + theta(1)*(x(9) - x(4))^2) + 2*theta(5)*sx(11,4)*x(2) + theta(1)*sx(7,4)*x(1) + theta(5)*sx(8,4)*x(2) - theta(1)*sx(4,4)*x(1)*(2*x(9) - 2*x(4)),x(2)*(2*x(11) + x(8)) - dsx(12,5)*x(2) - dx(12)*sx(2,5) + sx(9,5)*(theta(6)*x(2) + theta(1)*x(1)*(2*x(9) - 2*x(4))) - sx(12,5)*(2*theta(6)*x(2) + theta(1)*x(1)) + sx(2,5)*(2*x(11)*theta(5) - 2*x(12)*theta(6) + theta(5)*x(8) + theta(6)*x(9)) + sx(1,5)*(x(7)*theta(1) - x(12)*theta(1) + theta(1)*(x(9) - x(4))^2) + 2*theta(5)*sx(11,5)*x(2) + theta(1)*sx(7,5)*x(1) + theta(5)*sx(8,5)*x(2) - theta(1)*sx(4,5)*x(1)*(2*x(9) - 2*x(4)),sx(9,6)*(theta(6)*x(2) + theta(1)*x(1)*(2*x(9) - 2*x(4))) - dsx(12,6)*x(2) - dx(12)*sx(2,6) - sx(12,6)*(2*theta(6)*x(2) + theta(1)*x(1)) + sx(2,6)*(2*x(11)*theta(5) - 2*x(12)*theta(6) + theta(5)*x(8) + theta(6)*x(9)) - x(2)*(2*x(12) - x(9)) + sx(1,6)*(x(7)*theta(1) - x(12)*theta(1) + theta(1)*(x(9) - x(4))^2) + 2*theta(5)*sx(11,6)*x(2) + theta(1)*sx(7,6)*x(1) + theta(5)*sx(8,6)*x(2) - theta(1)*sx(4,6)*x(1)*(2*x(9) - 2*x(4));...
         ];

flag = 0;
new_data = [];