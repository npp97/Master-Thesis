function [res,flag,new_data] = MCM_res(t,x,dx,data) 

theta = data.params;

res = [theta(2)*x(2) - dx(1) - theta(1)*x(1);...
       theta(1)*x(1) - dx(2) + (-theta(2))*x(2);...
       (theta(2)*x(8) - theta(2)*x(3))*x(2) - dx(3)*x(1) - theta(4)*x(3)*x(1);...
       (theta(2)*x(9) - theta(2)*x(4))*x(2) - dx(4)*x(1) + (theta(5)*x(3)*x(1) - theta(6)*x(4)*x(1));...
       (theta(4)*x(3)*x(1) - 2*x(5)*theta(4)*x(1)) - dx(5)*x(1) + (x(10)*theta(2) - x(5)*theta(2) + theta(2)*(x(8) - x(3))^2)*x(2);...
       (x(11)*theta(2) - x(6)*theta(2) + theta(2)*(x(8) - x(3))*(x(9) - x(4)))*x(2) - dx(6)*x(1) + (x(5)*theta(5)*x(1) - x(6)*theta(4)*x(1) - x(6)*theta(6)*x(1));...
       (x(12)*theta(2) - x(7)*theta(2) + theta(2)*(x(9) - x(4))^2)*x(2) - dx(7)*x(1) + (2*x(6)*theta(5)*x(1) - 2*x(7)*theta(6)*x(1) + theta(5)*x(3)*x(1) + theta(6)*x(4)*x(1));...
       (theta(1)*x(3)*x(1) - theta(1)*x(8)*x(1)) - dx(8)*x(2) + (theta(3) - theta(4)*x(8))*x(2);...
       (theta(5)*x(8) - theta(6)*x(9))*x(2) - dx(9)*x(2) + (theta(1)*x(4)*x(1) - theta(1)*x(9)*x(1));...
       (theta(3) - 2*x(10)*theta(4) + theta(4)*x(8))*x(2) - dx(10)*x(2) + (theta(1)*x(1)*(x(8) - x(3))^2 - x(10)*theta(1)*x(1) + x(5)*theta(1)*x(1));...
       (x(10)*theta(5) - x(11)*theta(4) - x(11)*theta(6))*x(2) - dx(11)*x(2) + (x(6)*theta(1)*x(1) - x(11)*theta(1)*x(1) + theta(1)*x(1)*(x(8) - x(3))*(x(9) - x(4)));...
       (2*x(11)*theta(5) - 2*x(12)*theta(6) + theta(5)*x(8) + theta(6)*x(9))*x(2) - dx(12)*x(2) + (theta(1)*x(1)*(x(9) - x(4))^2 - x(12)*theta(1)*x(1) + x(7)*theta(1)*x(1))];

flag = 0;
new_data = [];