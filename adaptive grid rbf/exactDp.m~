function P = exactDp(P)
    if(P.adap_method == 1)
        MF=monitor_function(sqrt(((P.D0/P.d0)^2-1))*P.F/P.fmax,P.D0);
        
        if(P.kernel_aniso > 1)
            P.R = distm_mex(P.Tp,P.Tp);
        else
            P.R = distm_mex(P.Xp,P.Xp);
        end
        
        Dp = min(MF + (P.R(j,:)>P.adap_rstar)*max(P.adap_D);
        
        for j=1:P.N
            Dp(j) = min(MF+(P.R(j,:)>P.adap_rstar*MF)*)
            k=0;
        end
    else
        Dp = (P.D0 + P.d0)/2 * ones(size(P.F));
    end
    if(size(Dp,2)>size(Dp,1))
        Dp = Dp';
    end
    P.Dp=Dp;
    P.rcp=P.adap_rstar*P.Dp;
end