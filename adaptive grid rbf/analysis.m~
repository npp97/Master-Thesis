clear all;
clf

DefaultSettings

P = init(P);


Ns = 9;
Nsamples = 10;
ss = linspace(0,0.45,Ns);

for s=1:Ns
    for l = 1:Nsamples;
        Ps = P;
        Ps.adap_d0 = P.adap_d0 - ss(s);
        Ps.adap_D0 = P.adap_D0 - ss(s);
        tic;
        Ps = refine_particles( Ps );
        
        vTp(s,l)=toc;
        %% 2.5 Interpolation
        
        tic;
        Ps = interp(Ps);
        vTi(s,l)=toc;
        
        Ps = error_estim(Ps);
        
        
        vI(s,l) = sum(Ps.c)/abs(det(Ps.M*Ps.M'));
        vN(s,l) = Ps.N;
        vR(s,l) = Ps.Riter;
        vE(s,l) = Ps.inferror;
        
        vP(s,l) = Ps;
    end
end

%% Visualisation

    